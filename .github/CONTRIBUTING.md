# Furigana Maker Contributing Guide

Hi! We're Really excited that you are interested in contributing to Furigana Maker. Before submitting your contribution, please make sure to take a moment and Read through the following guidelines:

- [Code of Conduct](https://www.contributor-covenant.org/version/1/4/code-of-conduct/)
- [Pull Request Guidelines](#pull-request-guidelines)

## Pull Request Guidelines

- Checkout a topic branch from the relevant branch, e.g. `main`, and merge back against that branch.

- If adding a new feature:

  - Provide a convincing Reason to add this feature. Ideally, you should open a suggestion issue first and have it approved before working on it.

- If fixing bug:

  - Provide a detailed description of the bug in the PR. Live demo preferred.

- It's OK to have multiple small commits as you work on the PR - GitHub can automatically squash them before merging.

- Commit messages must be matched by the following regex, see [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) for more information.

```txt
/^(build|chore|ci|website|feat|fix|perf|refactor|revert|style|test)(\(.+\))?: .{1,100}/
```

## Development Setup

> [!IMPORTANT]
> The exact node version used by this project is located in the `.nvmrc` file.
> If you are using [nvm](https://github.com/nvm-sh/nvm), you can run `nvm use` to switch to the correct version.

You will need [pnpm](https://pnpm.io):

```bash
corepack enable pnpm
```

After cloning the repo, run:

```bash
pnpm install
cd packages/extension
```

Please read [WXT Documentation](https://wxt.dev/get-started/introduction.html) for more information on how to develop and test the extension.

### Setup Dev Environment

#### Chrome/Edge

```bash
pnpm run dev
```

After executing the above command, visit **chrome extensions page** `chrome://extensions/`, and click `Load unpacked` button, then select the `.output/chrome-mv3` folder in the project root directory, and try modifying the source code. You'll get live update.

### Get build target(.zip)

This `zip` command will package the directory generated by the `pnpm run build` command into a zip file suitable for the browser extension store.

#### Chrome/Edge: `.output/chrome-mv3.zip`

```bash
pnpm run zip
```

### E2E Test

In order to test browser extensions, playwright needs to use the `headless=new` mode, which can cause the behavior of `playwright test` and `playwright test --ui` to be inconsistent at times, be sure to use `playwright test` to ensure that the test passes.

```bash
pnpm run test:e2e
```

### Lint

```bash
pnpm run lint:fix
```

You may see a message saying "These CSS classes should be sorted", please ignore it.

This project integrates biome (linter and formatter) in git hook, which will trigger automatic fix of this error when committing, then you need to use `git commit --amend`.

### Publish

This repository uses Github Action by default to automatically generate changelog from commit messages and publish new version to Chrome Web Store.

To trigger manually, use the following command:

```bash
NEW_VERSION=X.X.X # Such as 1.1.1
git commit --allow-empty -m "chore: release $NEW_VERSION" -m "Release-As: $NEW_VERSION"
```